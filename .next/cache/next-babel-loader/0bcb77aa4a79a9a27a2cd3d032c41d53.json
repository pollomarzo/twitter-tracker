{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { CircularProgress, Fade, Button, makeStyles, TextField, NoSsr } from \"@material-ui/core\";\nimport { AlertWindow } from \"./\";\nimport styles from \"../../styles/Home.module.css\";\nconst useStyles = makeStyles(() => ({\n  textField: {\n    margin: 10,\n    width: 300,\n    [`& fieldset`]: {\n      borderWidth: 2,\n      borderRadius: 25\n    },\n    \"& .MuiOutlinedInput-root .MuiOutlinedInput-notchedOutline\": {\n      borderColor: \"#1DA1F2\"\n    },\n    \"& .MuiOutlinedInput-input\": {\n      color: \"#1DA1F2\"\n    },\n    \"& .MuiInputLabel-outlined\": {\n      color: \"#1DA1F2\"\n    }\n  },\n  submitButton: {\n    margin: 10,\n    width: 100,\n    fontWeight: 800,\n    color: \"white\",\n    backgroundColor: \"#1DA1F2\",\n    \"&:hover\": {\n      backgroundColor: \"lightblue\",\n      color: \"#1DA1F2\"\n    }\n  }\n}));\n\nconst MainContainer = () => {\n  const {\n    textField,\n    submitButton\n  } = useStyles(); // To set the id of the current stream\n\n  const {\n    0: streamId,\n    1: setStreamId\n  } = useState(undefined);\n  const {\n    0: error,\n    1: setError\n  } = useState(false); // A set of coords to initialize a geolocalized stream\n\n  const {\n    0: coords,\n    1: setCoordinates\n  } = useState({\n    latitudeStart: 0,\n    latitudeEnd: 0,\n    longitudeStart: 0,\n    longitudeEnd: 0\n  });\n\n  const handleChange = e => setCoordinates(_objectSpread(_objectSpread({}, coords), {}, {\n    [e.target.name]: e.target.value\n  }));\n\n  const openStream = () => {\n    // A stream is already opened, error!\n    if (streamId !== undefined) return;\n    let correctInput = true;\n    const correctFormatRegEx = RegExp(\"^-?[1]?[0-8]?[0-9][.][0-9]{2}$\"); // Check if the params are correct\n\n    Object.values(coords).forEach(value => correctInput = correctInput && correctFormatRegEx.test(value));\n\n    if (correctInput) {\n      axios.post(\"/api/geoFilter\", {\n        coordinates: `${coords.longitudeStart},${coords.latitudeStart},${coords.longitudeEnd},${coords.latitudeEnd}`\n      }).then(res => setStreamId(res.data)).catch(err => console.log(err));\n    } else setError(true);\n  };\n\n  const closeStream = () => {\n    // A stram wasn't opened before, error!\n    if (streamId === undefined) return;\n    axios.delete(\"/api/geoFilter\", {\n      data: {\n        id: streamId\n      },\n      headers: {\n        Authorization: \"***\"\n      }\n    }).then(_ => setStreamId(undefined)).catch(err => console.warn(err));\n  };\n\n  return /*#__PURE__*/_jsx(NoSsr, {\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.main,\n      children: [/*#__PURE__*/_jsx(\"header\", {\n        className: styles.title,\n        children: /*#__PURE__*/_jsx(\"h1\", {\n          className: styles.titleH1,\n          children: \"TWITTER TRACKER\"\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.form,\n        children: [/*#__PURE__*/_jsx(TextField, {\n          id: \"longitudeStart\",\n          className: textField,\n          label: \"Longitude start\",\n          variant: \"outlined\",\n          name: \"longitudeStart\",\n          required: true,\n          onChange: handleChange\n        }), /*#__PURE__*/_jsx(TextField, {\n          id: \"latitudeStart\",\n          className: textField,\n          label: \"Latitude start\",\n          variant: \"outlined\",\n          name: \"latitudeStart\",\n          required: true,\n          onChange: handleChange\n        }), /*#__PURE__*/_jsx(TextField, {\n          id: \"longitudeEnd\",\n          className: textField,\n          label: \"Longitude end\",\n          variant: \"outlined\",\n          name: \"longitudeEnd\",\n          required: true,\n          onChange: handleChange\n        }), /*#__PURE__*/_jsx(TextField, {\n          id: \"latitudeEnd\",\n          className: textField,\n          label: \"Latitude end\",\n          variant: \"outlined\",\n          name: \"latitudeEnd\",\n          required: true,\n          onChange: handleChange\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.submit,\n          children: [/*#__PURE__*/_jsx(Button, {\n            onClick: streamId ? closeStream : openStream,\n            variant: \"contained\",\n            className: submitButton,\n            color: \"default\",\n            children: streamId ? \"STOP\" : \"START\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(Fade, {\n              in: streamId !== undefined,\n              unmountOnExit: true,\n              children: /*#__PURE__*/_jsx(CircularProgress, {})\n            })\n          })]\n        }), /*#__PURE__*/_jsx(AlertWindow, {\n          isOpen: error,\n          onConfirm: setError,\n          title: \"Error\",\n          msg: \"An acceptable input is a number in range [-180.00, 180.00] written with this formula\"\n        })]\n      })]\n    })\n  });\n};\n\nexport default MainContainer;","map":null,"metadata":{},"sourceType":"module"}